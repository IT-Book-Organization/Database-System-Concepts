# 2.3 키

<br/>

1️⃣ 주어진 릴레이션 안에서 튜플을 구별하는 방법이 있어야 한다.

2️⃣ 이것은 릴레이션의 속성으로 표현되어야 한다.

즉, 튜플의 속성값은 그 튜플을 **유일하게 식별**할 수 있어야 한다.

<br/>

# 키(key)

<p align="center"><img width="520" alt="keys" src="https://user-images.githubusercontent.com/86337233/222129897-3f306ac1-2b49-4123-aaeb-0723355229cd.png">

<br/>
<br/>

## 슈퍼 키(super key)

`슈퍼 키`는 한 릴레이션에서 그 튜플을 유일하게 식별할 수 있도록 해주는 **하나 혹은 그 이상의 속성들의 집합**이다.

<br/>

e.g., instructor 릴레이션

- `ID 속성`은 하나의 instructor 튜플을 다른 튜플로부터 구별하는 데 충분하다.
- `name 속성`은 같은 이름을 가진 교수가 있을 수 있기 때문에 슈퍼 키가 아니다.

<br/>

릴레이션 r의 스키마에 존재하는 속성들의 집합을 R라고 하자. K는 R의 부분집합이다. (K ⊆ R)

K가 r의 슈퍼 키가 되기 위해서는, **서로 다른 두 튜플의 K의 모든 속성이 같아서는 안 된다.**

(튜플 t1과 t2가 r에 존재하고 t1 ≠ t2라면, t1.K ≠ t2.K여야 함)

<br/>

슈퍼 키는 관련 없는 속성을 포함할 수 있다.

instructor 릴레이션에서 `{ ID }`, `{ ID, name }` 전부 슈퍼 키이다.

**즉, 해당 정보를 갖고 특정인을 구별할 수 있다면 모두 슈퍼 키이다.**

<br/>
<br/>

## 후보 키(candidate key)

슈퍼 키들 중 **최소한의 정보만을 갖고 있는 것**을 `후보 키`라 한다.

다른 여러 속성들의 집합이 하나의 후보 키 역할을 할 수도 있다.

<br/>

instructor 릴레이션에서의 후보 키는 `{ ID }`이다.

<br/>
<br/>

## 주 키(primary key)

릴레이션 안에서 튜플을 구별하기 위한 수단으로 **데이터베이스 설계자에 의해 선택된 후보 키**는 `주 키`라고 지칭한다.

<br/>

> 주 키, 후보 키, 수퍼 키는 각 튜플의 특성이 아니라 전체 릴레이션의 특성이다.

릴레이션의 어떠한 튜플도 동시에 키 속성에 대해 같은 값을 가질 수 없다.

따라서 주 키는 `주 키 제약 조건(primary key constraint)`을 갖는다.

<br/>

> 주 키는 신중하게 선택해야 한다.

한 사람의 주민등록 번호를 속성으로 사용한다면 이것은 후보 키가 될 수 있다.

그러나 외국인에게는 주민등록번호가 주어지지 않으므로, 내국인과 외국인을 동시에 고용하는 기관은 자체적인 식별 방법이 필요할 것이다.

**키를 정하는 방법으로 여러 개의 속성을 동시에 이용하는 방법도 있다.**

<br/>

> 주 키는 그 속성이 절대로 변하지 않거나 매우 드물게 변하도록 선택해야 한다.

<br/>
<br/>

## 외래 키(foreign key)

instructor 릴레이션의 `dept_name` 속성을 생각해보자.

instructor 릴레이션에 나오는 어떤 튜플의 dept_name이 department 릴레이션에 나오지 않는다면 매우 이상할 것이다.

<br/>

instructor 릴레이션의 어떤 튜플 ta가 있다면, ta의 dept_name 속성값이 반드시 department 릴레이션에 존재해야 한다.

즉, ta의 dept_name 속성값이 dept_name을 주 키로 가지는 **department 릴레이션의 어떤 튜플 tb의 주 키로 나와야 한다**는 것이다.

<br/>

### 외래 키 제약 조건(foreign-key constraint)

릴레이션 스키마 r1의 속성 A와 다른 릴레이션 스키마 r2의 주 키 B 사이의 외래 키 제약 조건은  
모든 데이터베이스 인스턴스에 대해서 `r1에 존재하는 각 튜플의 A 값이 r2에 있는 어떤 튜플의 B 값으로 반드시 나와야 한다`는 것을 의미한다.

<br/>

- **속성 집합 A**를 r1으로부터 r2를 참조하는 `외래 키(foreign key)`라고 한다.
- 릴레이션 r1은 외래 종속을 가진 `참조하는 릴레이션(referencing relation)`이라고 부른다.
- 릴레이션 r2는 `참조된 릴레이션(referenced relation)`이라고 한다.

<br/>

즉, instructor의 속성 `dept_name`은 **instructor에서 department를 참조하는 외래 키다.**

`dept_name은` **department의 주 키다.**

<br/>

### 참조 무결성 제약 조건(referential integrity constraint)

참조하는 릴레이션의 어떤 튜플의 특정 속성에 출현하는 값이 **참조되는 릴레이션에서 적어도 하나의 튜플의 특정 속성으로 출현해야 한다.**

<br/>

외래키 제약 조건은 참조되는 속성이 참조된 릴레이션의 주 키를 구성하기 때문에 참조 무결성 제약 조건의 특별한 경우라고 볼 수 있다.

오늘날 데이터베이스 시스템은 외래 키 제약 조건을 지원하나, **참조되는 속성이 주 키가 아닌 참조 무결성 제약 조건은 지원하지 않는다.**
